<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UofT PEY Co-op Jobs (2023-2024 Fall/Winter)</title>

  <!-- Open Graph meta tags -->
  <meta property="og:title" content="UofT PEY Co-op Jobs (2023-2024 Fall/Winter)" />
  <meta property="og:description" content="Explore all PEY Co-op job postings for the 2023-2024 Fall/Winter term at the University of Toronto." />
  <meta property="og:image" content="public/static/twitter-card.png" />
  <meta property="og:url" content="https://sadman.ca/uoft-pey-coop-jobs-2023" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Sadman's Blog" />

  <!-- Twitter Card meta tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="UofT PEY Co-op Jobs (2023-2024 Fall/Winter)" />
  <meta name="twitter:description" content="Explore all PEY Co-op job postings for the 2023-2024 Fall/Winter term at the University of Toronto." />
  <meta name="twitter:image" content="public/static/twitter-card.png" />
  <meta name="twitter:site" content="@sadmanca" />

   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simplebar@latest/dist/simplebar.css">
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
   <script src="https://cdn.jsdelivr.net/npm/simplebar@latest/dist/simplebar.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise/dist/ag-grid-enterprise.min.js"></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

  <!-- Preconnect to the font file origin -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

  <!-- Preload the Inter Tight font CSS -->
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" />

  <!-- Asynchronously load the Inter Tight font CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" media="print" onload="this.media='all'" />

  <!-- Fallback: Load the Inter Tight font CSS synchronously if JavaScript is disabled -->
  <noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" />
  </noscript>

  <!-- Preload the Inter font CSS (if you need both variants of the Inter font) -->
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" />

  <!-- Asynchronously load the Inter font CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" media="print" onload="this.media='all'" />

  <!-- Fallback: Load the Inter font CSS synchronously if JavaScript is disabled -->
  <noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" />
  </noscript>

  <style>
    .ag-header-cell-label {
      white-space: normal; /* Allow text to wrap */
      overflow: hidden; /* Hide overflow text */
      text-overflow: ellipsis; /* Add ellipsis for overflow text */
      max-height: 3em; /* Limit header height to approximately 2 lines */
    }
  </style>

   <style>
    .cell-wrap-text {
      white-space: normal !important;
    }

    .ag-theme-quartz .ag-cell-value {
      line-height: 15px !important;
      word-break: break-word;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    .ag-theme-quartz-dark .ag-cell-value {
      line-height: 15px !important;
      word-break: break-word;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    .cell-ellipsis {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: normal;
    }

    .scrollable-cell {
      height: 100%;
      overflow-y: auto; /* Enables vertical scrolling */
    }

    .scrollable-cell::-webkit-scrollbar {
      display: block;
    }

    .simplebar-scrollbar::before {
      background-color: rgba(0, 0, 0, 0.1);
    }

    .scrollable-cell:hover .simplebar-scrollbar::before {
      background-color: rgba(0, 0, 0, 0.75);
    }

    /* Flexbox layout for body */
    body {
      display: flex;
      flex-direction: column; /* Stack elements vertically */
      height: 100vh; /* Full viewport height */
      margin: 0; /* Remove default margin */
      font-family: 'Inter Tight', sans-serif;
    }

    /* Container for buttons */
    .button-container {
      flex-shrink: 0; /* Prevent shrinking */
      margin: 10px 0;
      overflow-x: auto; /* Enable horizontal scrolling for buttons */
    }

    /* Adjusted grid container */
    #myGrid {
      flex-grow: 1; /* Allow the grid to take up remaining space */
      width: 100%; /* Full width */
      /* Removed fixed height to allow flexbox to control the size */
    }

    .ag-theme-quartz {
      /* --ag-grid-size: 3px;  */
      /* --ag-header-height: 80px; */
    }

    .blog-btn {
      background-color: #dfd2fd; /* Light purple background */
      /* border: 3px solid black;  */
      color: black; /* Text color */
      font-weight: bold;
    }
    .blog-btn:hover {
      background-color: #cdbafd; /* Slightly darker on hover */
    }

    .pey-btn {
      background-color: #4663aa; /* Light purple background */
      /* border: 3px solid black;  */
      color: white; /* Text color */
      font-weight: bold;
    }
    .pey-btn:hover {
      color: white; /* Text color */
      background-color: #3c5491; /* Slightly darker on hover */
    }

    .btn-sm {
      padding: 0.25rem 0.5rem;
      font-size: 0.75rem;
      line-height: 1.5;
      border-radius: 0.2rem;
    }

    .right-buttons {
      margin-right: 4px;
    }

    .btn-sm {
      margin-top: 2px; /* Adjust the value as needed */
      margin-bottom: 2px; /* Adjust the value as needed */
    }

    .ag-tooltip{
      max-width: 300px;
    }

  </style>
  <noscript>
    <style>
      /**
      * Reinstate scrolling for non-JS clients
      */
      .simplebar-content-wrapper {
        scrollbar-width: auto;
        -ms-overflow-style: auto;
      }

      .simplebar-content-wrapper::-webkit-scrollbar,
      .simplebar-hide-scrollbar::-webkit-scrollbar {
        display: initial;
        width: initial;
        height: initial;
      }
    </style>
  </noscript>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q095PB1G6R"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-Q095PB1G6R');
  </script>
 </head>
  <body>
    <div id="buttonContainer" style="padding: 4px" class="d-flex justify-content-between align-items-center flex-wrap">
      <div class="d-flex justify-content-between align-items-center flex-wrap" style="padding: 4px;">
        <h5 id='workStudyTitle' class="mb-0"><b>UofT PEY Co-op Jobs</b> (2023-2024 Fall/Winter)</h5>
        <div class="d-flex justify-content-end">
          <span style="margin: 0 5px;"> </span>
          <button class="btn blog-btn btn-sm right-buttons" onclick="window.open('/', '_blank')">
            <i class="fa-solid fa-circle" style="color: #6e46e7;"></i> Sadman's Blog
          </button>
          <button id="dataButton" class="btn btn-dark btn-sm right-buttons" onclick="window.open('posts/analyzing-pey-postings-part-1/', '_blank')">
            <i class="fa-solid fa-circle-question"></i> <i>How was this data sourced?</i>
          </button>
          <button id="githubButton" class="btn btn-dark btn-sm right-buttons" onclick="window.open('https://github.com/sadmanca/uoft-pey-coop-job-postings', '_blank')">
            <i class="fa-brands fa-github"></i>
          </button>
          <button class="btn btn-primary btn-sm right-buttons" onclick="window.open('https://linkedin.com/in/sadmanca', '_blank')">
            <i class="fa-brands fa-linkedin"></i>
          </button>
        </div>
      </div>

      <div id="buttonContainer" style="padding: 4px" class="d-flex justify-content-between align-items-center flex-wrap">
        <div>
          <button class="btn pey-btn btn-sm btn-spacing" onclick="window.open('https://discover.engineering.utoronto.ca/experiential-learning/professional-experience-year-pey/', '_blank')">
            <i class="fa-solid fa-circle-question"></i> What is PEY Co-op?
          </button>
          <span style="margin: 0 2px;">|</span>
          <button id="groupByCompanyButton" class="btn btn-warning btn-sm" onclick="groupByCompany()">
            <i class="fas fa-layer-group"></i> Group by Company
          </button>
          <span style="margin: 0 2px;">|</span>
          <!-- <button class="btn btn-outline-success btn-sm" disabled onclick="exportSelectedRowsToExcel()">
            <i class="fas fa-file-excel"></i> Export Selected Rows to Excel
          </button> -->
          <button id="exportCsvButton" class="btn btn-outline-primary btn-sm" disabled onclick="exportSelectedRowsToCSV()">
            <i class="fas fa-file-csv"></i> Export Selected Rows to CSV
          </button>
          <button id="exportExcelButton" class="btn btn-outline-success btn-sm" disabled onclick="exportSelectedRowsToExcel()">
            <i class="fas fa-file-excel"></i> Export Selected Rows to Excel
          </button>
          <span style="margin: 0 2px;">|</span>
          <button class="btn btn-primary btn-sm" onclick="exportAllRowsToCSV()">
            <i class="fas fa-file-csv"></i> Download CSV
          </button>
          <button class="btn btn-success btn-sm" onclick="exportAllRowsToExcel()">
            <i class="fas fa-file-excel"></i> Download Excel
          </button>
          <!-- <button id="hideExpiredJobsButton" class="btn btn-sm" style="background-color: #520000; border-color: #520000; color: #fff;">
            <i class="fas fa-xmark"></i> Hide Expired Jobs
          </button> -->
          <!-- <button id="showExpiringJobsButton" class="btn btn-sm" style="background-color: #525200; border-color: #525200; color: #fff;">
            <i class="fas fa-clock"></i> Jobs Expiring Soon
          </button> -->
          <!-- <span style="margin: 0 2px;">|</span>
          <button id="toggleThemeButton" class="btn btn-outline-dark btn-sm" onclick="toggleTheme()">
            <i class="fas fa-moon"></i> Dark Mode -->
          </button>
        </div>
      </div>
    </div>
    <div id="myGrid" style="width: 100%; height: 100%"></div>
  </body>
</html>

<script>
  document.addEventListener('DOMContentLoaded', function() {
      const gridDiv = document.getElementById('myGrid');
      const buttonContainer = document.getElementById('buttonContainer');
      const toggleButton = document.getElementById('toggleThemeButton');
      const dataButton = document.getElementById('dataButton');
      const githubButton = document.getElementById('githubButton');
      const workStudyTitle = document.getElementById('workStudyTitle');
      const savedTheme = localStorage.getItem('theme');
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const override = false;

      // Listen for messages from the parent document
      window.addEventListener('message', function(event) {
        if (event.data && typeof event.data.isDarkMode !== 'undefined') {
          prefersDarkScheme = event.data.isDarkMode;
          override = true;
          // You can now use isDarkMode in your script
        }
      });

      if (savedTheme) {
          applyTheme(savedTheme);
      } else if (prefersDarkScheme) {
          applyTheme('dark');
      } else {
          applyTheme('light');
      }

      toggleButton.addEventListener('click', toggleTheme);

      function applyTheme(theme) {
          if (theme === 'dark') {
              gridDiv.classList.remove('ag-theme-quartz');
              gridDiv.classList.add('ag-theme-quartz-dark');
              buttonContainer.style.backgroundColor = '#1c232e';
              document.body.style.backgroundColor = '#1c232e';
              toggleButton.classList.remove('btn-outline-dark');
              toggleButton.classList.add('btn-outline-light');
              githubButton.classList.remove('btn-dark');
              githubButton.classList.add('btn-light');
              dataButton.classList.remove('btn-dark');
              dataButton.classList.add('btn-light');
              workStudyTitle.style.color = '#ffffff';
              toggleButton.innerHTML = '<i class="fas fa-circle"></i> Light Mode';
          } else {
              gridDiv.classList.remove('ag-theme-quartz-dark');
              gridDiv.classList.add('ag-theme-quartz');
              buttonContainer.style.backgroundColor = '#fff';
              document.body.style.backgroundColor = '#fff';
              toggleButton.classList.remove('btn-outline-light');
              toggleButton.classList.add('btn-outline-dark');
              githubButton.classList.remove('btn-light');
              githubButton.classList.add('btn-dark');
              dataButton.classList.remove('btn-light');
              dataButton.classList.add('btn-dark');
              workStudyTitle.style.color = '#000000';
              toggleButton.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
          }
          localStorage.setItem('theme', theme);
      }

      function toggleTheme() {
          const currentTheme = gridDiv.classList.contains('ag-theme-quartz') ? 'light' : 'dark';
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          applyTheme(newTheme);
      }
  });
</script>

<script>
  function scrollableCellRenderer(params) {
    // Check if params.value exists and replace newline characters with HTML line breaks
    const formattedValue = params.value ? params.value.replace(/\n/g, '<br><br>') : '';
    return `<div class="scrollable-cell" data-simplebar data-simplebar-auto-hide="false">${formattedValue}</div>`;
  }

  function CompanyWebsiteRenderer(params) {
    // Ensure params.value is defined and is a string
    if (typeof params.value !== 'string') return '';

    // Extract the first URL from the text
    const urlMatch = params.value.match(/https?:\/\/[^ \n]+/);
    if (!urlMatch) return params.value; // Return original text if no URL found

    let firstUrl = urlMatch[0];
    // Replace any "/)" with "/"
    firstUrl = firstUrl.replace('/)', '/');

    const link = `<a href="${firstUrl}" target="_blank">${new URL(firstUrl).hostname}</a>`;
    return link;
  }

  function updateExportButtonsState() {
    const noRowsSelected = gridApi && gridApi.getSelectedRows().length === 0;
    document.getElementById('exportCsvButton').disabled = noRowsSelected;
    document.getElementById('exportExcelButton').disabled = noRowsSelected;
  }

  function MultiLineTextCellEditor() {}

  MultiLineTextCellEditor.prototype.init = function(params) {
    this.params = params;
    this.eGui = document.createElement('textarea');
    this.eGui.style.width = '100%';
    this.eGui.style.height = '100%';
    this.eGui.value = params.value;
  };

  MultiLineTextCellEditor.prototype.getGui = function() {
    return this.eGui;
  };

  MultiLineTextCellEditor.prototype.afterGuiAttached = function() {
    this.eGui.focus();
    this.eGui.select();
  };

  MultiLineTextCellEditor.prototype.getValue = function() {
    return this.eGui.value;
  };

  MultiLineTextCellEditor.prototype.destroy = function() {};

  const gridOptions = {
    columnDefs: [
      {
        headerCheckboxSelection: true, // Enable checkbox on the header
        checkboxSelection: true, // Enable row checkboxes
        field: "postingDate",
        width: 160,
        rowGroup: false,
        hide: false,
        pinned: 'left',
        filter: "agDateColumnFilter",
        filterParams: {
          comparator: filterDateComparator
        },
        sortable: true,
        sort: 'asc',
        comparator: dateComparator,
        cellEditor: MultiLineTextCellEditor,
        tooltipValueGetter: function(params) {
          return `Date when job was posted on the PEY portal`;
        },
      },
      {
        field: "title",
        width: 120,
        pinned: 'left',
      },
      {
        field: "company",
        hide: false,
        width: 117,
      },
      {
        field: "companyWebsite",
        cellRenderer: CompanyWebsiteRenderer,
        width: 117,
      },
      {
        field: "location",
        width: 113,
      },
      {
        field: "locationType",
        width: 113,
        cellRenderer: scrollableCellRenderer,
      },
      {
        field: "numPositions",
        headerName: "Num. Positions",
        width: 112,
        filterParams: {
          filters: [
            { filter: "agNumberColumnFilter" },
            { filter: "agSetColumnFilter" },
          ],
        },
        // Use a value formatter to check the value before displaying
        valueFormatter: function(params) {
          // Check if the value is a valid number
          const isValidNumber = !isNaN(params.value) && isFinite(params.value);
          // Return the value if it's a valid number, otherwise return an empty string
          return isValidNumber ? params.value : '';
        },
      },
      {
        field: "description",
        width: 350,
        wrapText: true,
        // cellClass: 'cell-wrap-text',
        // autoHeight: true,
        cellRenderer: scrollableCellRenderer,
        filter: 'agTextColumnFilter',
      },
      {
        field: "requirements",
        width: 350,
        wrapText: true,
        // cellClass: 'cell-wrap-text',
        // autoHeight: true,
        cellRenderer: scrollableCellRenderer,
        filter: 'agTextColumnFilter',
      },
      {
        field: "preferredDisciplines",
        width: 140,
        // wrapText: false,
        cellRenderer: scrollableCellRenderer,
        filter: 'agTextColumnFilter',
      },
      {
        field: "salary",
        width: 100,
      },
      {
        field: "startDate",
        width: 110,
        filterParams: {
          filters: [
            { filter: "agDateColumnFilter", },
            { filter: "agSetColumnFilter", },
          ],
        },
      },
      {
        field: "endDate",
        width: 110,
        filterParams: {
          filters: [
            { filter: "agDateColumnFilter", },
            { filter: "agSetColumnFilter", },
          ],
        },
      },
      {
        field: "companyDivision",
        width: 120,
      },
      {
        field: "function",
        width: 120,
      },
    {
      field: "applicationDeadline",
      width: 130,
      filter: 'agDateColumnFilter',
      filterParams: {
          comparator: appDeadlineFilterDateComparator
        },
      sortable: true,
      comparator: appDeadlineSortDateComparator
    },
    // Uncomment and include additional fields as needed
    // {
    //   field: "applicationMethod",
    // },
    {
      field: "applicationReceiptProcedure",
      headerName: "Application Procedure",
      width: 130,
      cellRenderer: scrollableCellRenderer,
      filter: 'agTextColumnFilter',
    },
    {
      field: "applicationDetails",
      width: 130,
      cellRenderer: scrollableCellRenderer,
      filter: 'agTextColumnFilter',
      hide: true,
    },
    {
      field: "id",
      headerName: "Job ID",
      width: 100,
      hide: true,
      filterParams: {
        filters: [
          { filter: "agNumberColumnFilter" },
          { filter: "agSetColumnFilter" },
        ],
      },
    }
    ],

    defaultColDef: {
      enableRowGroup: true,
      wrapHeaderText: true, // Allow header text to wrap
      autoHeaderHeight: true, // Automatically adjust header height
      resizable: true,
      sortable: true,
      initialWidth: 170,
      editable: true,
      filter: true,
      wrapText: true,
      cellEditor: MultiLineTextCellEditor,
      wrapHeaderText: true,
      autoHeaderHeight: true,
      floatingFilter: true,
      filter: "agMultiColumnFilter",
      filterParams: {
        filters: [
          { filter: "agTextColumnFilter", },
          { filter: "agSetColumnFilter", },
        ],
      },
      },

    groupUseEntireRow: true,


    // rowHeight: 250,
    getRowHeight: function(params) {
      // Check if the row is a group row
      if (params.node.group) {
        // Return the desired height for group rows
        return 30; // Example: Set group row height to 100px
      }
      // Return a different height for non-group rows or default height
      return 250; // Example: Set non-group row height to 25px
    },

    rowSelection: 'multiple',
    onSelectionChanged: updateExportButtonsState,
    rowMultiSelectWithClick: true, // Allow multiple rows to be selected with clicks

    groupDefaultExpanded: -1,
    groupDisplayType: 'groupRows',
    rowGroupPanelShow: 'always',

    tooltipShowDelay: 500,
    tooltipHideDelay: 1200,
    tooltipMouseTrack: true,

    statusBar: {
      statusPanels: [
       {
          statusPanel: "agTotalAndFilteredRowCountComponent",
          align: "left",
        },
       {
          statusPanel: "agSelectedRowCountComponent",
          align: "left",
        },
      ],
    },
    enableRangeSelection: true,
    // Function to determine if a row should be selectable
    isRowSelectable: function(rowNode) {
      // Return false if the row is a group row, making it not selectable
      return !rowNode.group;
    },

    pivotMode: false,
    sideBar: {
      toolPanels: [
        {
          id: "columns",
          labelDefault: "Columns",
          labelKey: "columns",
          iconKey: "columns",
          toolPanel: "agColumnsToolPanel",
          width: 250,
          toolPanelParams: {
            suppressValues: true, // This will hide the aggregation options
            suppressPivotMode: true, // This will hide the pivot mode options
          },
        },
        {
          id: "filters",
          labelDefault: "Filters",
          labelKey: "filters",
          iconKey: "filter",
          toolPanel: "agFiltersToolPanel",
          width: 200,
        },
      ],
      defaultToolPanel: "columns",
    },

    pagination: false,
    // paginationPageSize: 1,
    // paginationPageSizeSelector: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],

    isExternalFilterPresent: isExternalFilterPresent,
    doesExternalFilterPass: doesExternalFilterPass,

  };

  function generateReadableTimestamp() {
    const date = new Date();
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    const seconds = String(date.getSeconds()).padStart(2, '0');
    return `${year}_${month}_${day}-${hours}_${minutes}_${seconds}`;
  }

  // Function to generate the filename with a readable timestamp
  function generateFilename(baseName, extension) {
    const timestamp = generateReadableTimestamp();
    return `${baseName}-${timestamp}.${extension}`;
  }

  function exportSelectedRowsToCSV() {
    if (gridApi) {
      const filename = generateFilename('SELECTED-uoft-pey-coop-jobs', 'csv');
      gridApi.exportDataAsCsv({
        onlySelected: true,
        fileName: filename
      });
    } else {
      console.error('Grid API is not available.');
    }
  }

  function exportSelectedRowsToExcel() {
    if (gridApi) {
      const filename = generateFilename('SELECTED-uoft-pey-coop-jobs', 'xlsx');
      gridApi.exportDataAsExcel({
        onlySelected: true,
        fileName: filename
      });
    } else {
      console.error('Grid API is not available.');
    }
  }

  function exportAllRowsToCSV() {
    const filename = generateFilename('ALL-uoft-pey-coop-jobs', 'csv');
    if (gridApi) {
      gridApi.exportDataAsCsv({
        onlySelected: false,
        fileName: filename
      });
    } else {
      console.error('Grid API is not available.');
    }
  }

  function exportAllRowsToExcel() {
    const filename = generateFilename('ALL-uoft-pey-coop-jobs', 'xlsx');
    if (gridApi) {
      gridApi.exportDataAsExcel({
        onlySelected: false,
        fileName: filename
      });
    } else {
      console.error('Grid API is not available.');
    }
  }

  // Function to check window width and toggle side panel
  function checkWindowWidth() {
    if (window.innerWidth < 1600) {
      gridApi.closeToolPanel();
    } else {
      gridApi.openToolPanel('columns');
    }

    if (window.innerWidth < 1000) {
      // Unpin all columns using gridApi
      const allColumns = gridApi.getColumnDefs();
      allColumns.forEach(col => {
        gridApi.setColumnPinned(col.field, null);
      });
    }
  }

  // Function to compare dates for sorting
  function appDeadlineSortDateComparator(date1, date2) {
    // Check if date1 or date2 is undefined or empty
    if (!date1 || !date2) {
      return 0;
    }

    // Parse the date1 to a Date object
    const dateParts1 = date1.split(/\s+/);
    const month1 = dateParts1[0];
    const day1 = parseInt(dateParts1[1].replace(',', ''));
    const year1 = parseInt(dateParts1[2]);
    const parsedDate1 = new Date(`${month1} ${day1}, ${year1}`);

    // Parse the date2 to a Date object
    const dateParts2 = date2.split(/\s+/);
    const month2 = dateParts2[0];
    const day2 = parseInt(dateParts2[1].replace(',', ''));
    const year2 = parseInt(dateParts2[2]);
    const parsedDate2 = new Date(`${month2} ${day2}, ${year2}`);

    // Compare the dates
    if (parsedDate1 < parsedDate2) {
      return -1;
    } else if (parsedDate1 > parsedDate2) {
      return 1;
    } else {
      return 0;
    }
  }

  // Function to compare dates for filtering
  function appDeadlineFilterDateComparator(filterLocalDateAtMidnight, cellValue) {
    // Parse the cell value to a Date object
    const dateParts = cellValue.split(/\s+/);
    const month = dateParts[0];
    const day = parseInt(dateParts[1].replace(',', ''));
    const year = parseInt(dateParts[2]);
    const date = new Date(`${month} ${day}, ${year}`);

    // Compare the dates
    if (date < filterLocalDateAtMidnight) {
      return -1;
    } else if (date > filterLocalDateAtMidnight) {
      return 1;
    } else {
      return 0;
    }
  }

  function dateComparator(date1, date2) {
    if (!date1 || !date2) {
      return 0;
    }
    const parsedDate1 = new Date(date1);
    const parsedDate2 = new Date(date2);
    return parsedDate1 - parsedDate2;
  }

  function filterDateComparator(filterLocalDateAtMidnight, cellValue) {
    const date = new Date(cellValue);
    if (date < filterLocalDateAtMidnight) {
      return -1;
    } else if (date > filterLocalDateAtMidnight) {
      return 1;
    } else {
      return 0;
    }
  }

  // External filter to hide rows with blank postingDate
  function isExternalFilterPresent() {
    return true; // External filter is always active
  }

  function doesExternalFilterPass(node) {
    return node.data.postingDate; // Pass only if postingDate is not blank
  }

  function groupByCompany() {
    const currentGroupColumns = gridApi.getRowGroupColumns().map(col => col.getColId());
    const isGroupedByCompany = currentGroupColumns.includes('company');

    function getSortModel() {
        const sortState = gridApi.getAllColumns().map(col => ({
            colId: col.getColId(),
            sort: col.getSort()
        })).filter(col => col.sort != null);
        return sortState.length > 0 ? sortState : [];
    }

    function setSortModel(sortModel) {
        gridApi.applyColumnState({
            state: sortModel,
            applyOrder: true
        });
    }

    if (isGroupedByCompany) {
        // Clear grouping and revert sort
        gridApi.setRowGroupColumns([]);
        setSortModel([{ colId: 'company', sort: 'asc' }]);
        gridApi.setColumnVisible('company', true); // Ensure the column is visible after ungrouping
    } else {
        // Group by Company, show the Company column, and sort by Company in ascending order
        gridApi.setRowGroupColumns(['company']);
        gridApi.setColumnVisible('company', true); // Ensure the column is visible
        setSortModel([{ colId: 'company', sort: 'asc' }]);
    }

    gridApi.refreshClientSideRowModel('group');
}


  document.addEventListener("DOMContentLoaded", function () {
    var gridDiv = document.querySelector("#myGrid");
    gridApi = agGrid.createGrid(gridDiv, gridOptions);

    fetch("/data/PEYJobPosting.json")
      .then((response) => response.json())
      .then((data) => gridApi.setGridOption("rowData", data));

    checkWindowWidth();
    window.addEventListener('resize', checkWindowWidth);
  });

</script>

<!--
for mapping pages to dates:

// Example mapping of page numbers to dates
const pageNumberToDateMap = {
  1: '2023-01-01',
  2: '2023-01-02',
  // Add more mappings as needed
};
const lastDate = '2023-01-31'; // Example last date

const gridOptions = {
  // Other grid options...
  pagination: true,
  paginationPageSize: 1,
  paginationNumberFormatter: function(params) {
    const currentPageDate = pageNumberToDateMap[params.value] || 'Unknown Date';
    return `${currentPageDate} out of ${lastDate}`;
  },
  // Other options like columnDefs, rowData, etc.
};

<div class="ag-tooltip ag-tooltip-animate ag-ltr ag-popup-child ag-tooltip-hiding" role="dialog" aria-label="Tooltip" style="top: 279px; left: 1230px;">Full Stack Engineer, Business Systems at ecobee</div>
-->